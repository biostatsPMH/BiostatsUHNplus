[["index.html", "Example nested reportRmd and Bayesian hierarchical model summary 1 Overview", " Example nested reportRmd and Bayesian hierarchical model summary 1 Overview This is a demonstration of how to use reportRmd with the BiostatsUHNplus package for example data with rm_covsum() and R Markdown. A nested version of function, rm_nested_covsum() is demonstrated. The modified data set is “Milk” from the nlme package. It comprises 1337 observations of milk protein content from 79 cows. High protein is milk \\(\\geq\\) 3.6 percent protein. Yard variable (5 sites) is spurious and was added to data set. Word of caution: As with reportRmd, the BiostatsUHNplus package is designed for statistical reporting and does not provide checks on the suitability of model fit. "],["exploratory-analysis.html", "2 Exploratory analysis ", " 2 Exploratory analysis "],["summary-of-high-protein-status.html", "2.1 Summary of high protein status", " 2.1 Summary of high protein status 2.1.1 By data record (row): This uses the reportRmd:::rm_covsum() function to summarize Milk data set. However, we know that this data has a nested structure by both cow and yard. rm_covsum(data = Milk, covs = c(&quot;protein&quot;, &quot;Time&quot;, &quot;Diet&quot;), maincov = &quot;High_Protein&quot;, testcat = &quot;Fisher&quot;) Full Sample (n=1337) N (n=951) Y (n=386) p-value protein &lt;0.001 Mean (sd) 3.4 (0.3) 3.3 (0.2) 3.8 (0.2) Median (Min,Max) 3.4 (2.5, 4.6) 3.3 (2.5, 3.6) 3.8 (3.6, 4.6) Time 0.04 Mean (sd) 9.2 (5.2) 9.4 (4.9) 8.7 (5.7) Median (Min,Max) 9 (1, 19) 9 (1, 19) 9 (1, 19) Diet &lt;0.001 barley 425 (32) 242 (25) 183 (47) barley+lupins 459 (34) 340 (36) 119 (31) lupins 453 (34) 369 (39) 84 (22) 2.1.2 By cow in yard at observation instance: Y denotes high protein milk sample, N denotes non-high protein milk sample. Milk_t &lt;- reshape2::dcast(Milk, Yard + Cow ~ Time, value.var=&quot;High_Protein&quot;); colnames(Milk_t)[-c(1:2)] &lt;- paste(&quot;&quot;, colnames(Milk_t[, -c(1:2)]), &quot;&quot;, sep = &quot;&quot;); options(knitr.kable.NA = &#39;&#39;); knitr::kable(Milk_t); Yard Cow 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 1 B07 Y Y N N Y N Y Y Y Y Y Y N N N N N N 1 B08 Y Y N N Y N N Y Y Y Y Y Y Y Y Y Y Y 1 B12 Y Y Y N Y N Y Y Y N N N 1 B13 Y Y Y N Y N N Y Y N N N N N 1 B22 Y Y N N Y N Y N Y Y Y Y Y Y Y Y N N N 1 B24 N Y N N N N Y N N N N N Y Y Y Y Y Y N 1 BL04 Y Y Y Y Y Y Y Y Y Y N N N N 1 BL20 Y Y N N N N N Y Y N N N N N 1 BL22 Y N N N N N N Y N Y N Y Y Y N N N N N 1 L16 Y N N N N N N N N N N N N N N N N N N 1 L18 Y N N N N N N N Y Y Y N N N N N 1 L20 Y N N N N N N N N N N N N N N N N N Y 1 L21 N N N N N N N N N N N N N N N N N N N 2 B15 Y Y N N N Y N N Y N N N N N N 2 B17 Y Y N N N N N N N N N N N N N Y Y N N 2 B20 Y N N N N N N N N Y N N Y Y N N N N 2 B21 N N Y N N N Y N N Y Y N N N N N 2 BL12 Y N N N N N N N N N N N Y N Y N N N N 2 BL25 Y Y N Y Y Y Y Y Y Y N N N N 2 BL27 Y Y N N N Y N N N N N Y Y Y Y Y Y N 2 L11 Y N N N N N N N N N N N N N 2 L24 Y Y N N N N N N N N N N N N N N Y N N 3 B01 Y N N Y Y Y Y Y Y Y Y Y Y Y Y Y Y Y Y 3 B02 N N N N N N N N N N N N N N N N N N N 3 B10 Y Y Y N N N N N N Y N N Y Y Y Y Y Y Y 3 B11 Y N N N N Y N N Y Y Y Y Y Y Y Y Y N N 3 B23 Y Y Y N Y Y N Y Y N N N N N 3 BL02 Y N N N N N N N Y Y Y Y Y Y N Y Y N Y 3 BL11 Y N N N N N N N N N N N N N N N N N N 3 BL21 N N N N N Y N N Y N N N N N N 3 BL26 Y Y Y N N N N N Y N N Y Y Y Y Y Y N 3 L01 Y N N N N N N N N Y N N Y Y Y Y Y Y N 3 L02 Y N N N N N N N N N N N N N N N N N N 3 L03 N N N N N N N N N N N N N N N N N N N 3 L05 Y Y Y Y N N N N N N N N N N Y Y N Y N 3 L07 N N N N N N N N N N N N N N N N N N N 3 L15 N N N N N N N N N N N N N N N 4 B06 Y Y N Y Y Y Y Y Y Y Y Y Y N 4 B16 Y N Y N N N N N N N N N N N N N 4 B18 Y Y N N N N N N N N Y Y Y Y Y Y Y Y Y 4 BL03 Y Y N N N N N N N N N N N N N N N N N 4 BL07 N N Y N N N N N N Y N Y N N N N 4 BL09 Y N N N Y N N N N N N N N N 4 BL10 N Y N N N Y N Y Y Y Y N N N N 4 BL14 Y Y N N N N N N N N N N N Y N N Y N N 4 BL15 Y N N N N N N N N N N N N N 4 BL16 N N N N N N N N N N N N N N Y N N N N 4 BL17 Y Y N N N N N N Y Y N Y Y Y Y Y N N N 4 BL19 N N N N N Y N N Y Y N N N N N 4 BL23 Y N Y N N N N Y N N Y N N N 4 BL24 Y N N N N Y N N N N N N N N N N Y N N 4 L04 N N N N N N N N N N N Y Y Y Y N N N N 4 L06 Y Y Y N N N N N N N N N N N 4 L09 Y N N N N N N N N N N N N N N N N N N 4 L23 Y Y Y Y Y Y Y Y Y N N N N N 4 L27 Y Y Y Y Y N Y Y Y N N N Y N 5 B03 Y Y N N N N N N N N N N N N 5 B04 Y N N N N N N N N N N N N N N N N N 5 B05 Y Y Y N N N Y Y Y Y Y Y Y Y Y N N N N 5 B09 N N N N N N N N N N Y N N N Y Y Y Y Y 5 B14 Y N N N N N N N N N N N N N 5 B19 Y Y Y Y Y Y Y N Y N N Y N Y Y Y Y Y Y 5 B25 N Y N N N N Y N Y N N N N N N 5 BL01 N N N N N N N N N N Y Y N N Y N N N N 5 BL05 Y N N N Y N N N N N N N N N 5 BL06 Y N N N N N N N Y N N Y N N N Y Y N Y 5 BL08 Y N N N N N N N N N N N N N N N N N N 5 BL13 N Y N N N N N N N N N N N N N Y Y Y Y 5 BL18 N N N N N N N N N N N N N N N N N 5 L08 Y N N N N N N N N N N Y N N N N N N 5 L10 Y Y Y Y Y N N N N N N N N N N 5 L12 Y N N N N N Y Y N N N N N 5 L13 N Y N N N N N Y Y Y Y N N N N 5 L14 N N N N N N N N N N N N N N 5 L17 N N N N N Y Y N N N N N 5 L19 N N N N N N N N N N N N N N N N N Y N 5 L22 Y N N N N Y N Y N N N Y Y N N N N N 5 L25 Y N N N N N N N N N N N N N 5 L26 Y N N N N N N Y Y Y N N Y Y Y N N N N "],["nested-summary-of-high-protein-status.html", "2.2 Nested summary of high protein status", " 2.2 Nested summary of high protein status 2.2.1 By cow: There are 72 cows that had at least one instance of milk with high protein content. Every cow (all 79) had at least one instance of milk with low protein content. rm_covsum_nested(data = Milk, id = c(&quot;Cow&quot;), covs = c(&quot;protein&quot;, &quot;Time&quot;, &quot;Diet&quot;, &quot;Yard&quot;), maincov = &quot;High_Protein&quot;) ## Warning in (function (data, covs, maincov = NULL, id = NULL, digits = 1, : Use this function at your own risk. Please check output. ## Order of nested ids matter. For example, in c(&#39;id1&#39;,&#39;id2&#39;) id1 should be nested within id2, etc. ## Warning in (function (data, covs, maincov = NULL, id = NULL, digits = 1, : Unnested p-value and statistical test is incorrect for nested data, but is kept for comparison to nested p-value. ## Nested p-value derived from anova(afex::mixed(maincov ~ cov + (1|id1:id2:...idn), family=binomial, data, method=&#39;LRT&#39;)). ## ## Using 12 processor(s) for parallel processing. Full Sample (n=79) N (n=79) Y (n=72) Unnested p-value Nested p-value protein &lt;0.001 Did not converge;quasi or completecategory separation Mean (sd) 3.4 (0.2) 3.3 (0.1) 3.8 (0.1) Median (Min,Max) 3.4 (2.9, 3.9) 3.3 (2.9, 3.5) 3.8 (3.6, 4.2) Time 0.001 0.02 Mean (sd) 9.0 (1.1) 9.2 (1.5) 7.4 (4.3) Median (Min,Max) 10.0 (7.1, 10.4) 9.4 (2.5, 12.5) 7.7 (1.0, 18.0) Diet 0.89 &lt;0.001 barley 25 (32) 25 (32) 24 (33) barley+lupins 27 (34) 27 (34) 26 (36) lupins 27 (34) 27 (34) 22 (31) Yard 0.98 0.44 1 13 (16) 13 (16) 12 (17) 2 9 (11) 9 (11) 9 (12) 3 15 (19) 15 (19) 11 (15) 4 19 (24) 19 (24) 19 (26) 5 23 (29) 23 (29) 21 (29) 2.2.2 By cow nested in yard: Notice that this summary is the same as by cow, since each cow stays in only one yard for this example data. rm_covsum_nested(data = Milk, id = c(&quot;Cow&quot;, &quot;Yard&quot;), covs = c(&quot;protein&quot;, &quot;Time&quot;, &quot;Diet&quot;), maincov = &quot;High_Protein&quot;) Full Sample (n=79) N (n=79) Y (n=72) Unnested p-value Nested p-value protein &lt;0.001 Did not converge;quasi or completecategory separation Mean (sd) 3.4 (0.2) 3.3 (0.1) 3.8 (0.1) Median (Min,Max) 3.4 (2.9, 3.9) 3.3 (2.9, 3.5) 3.8 (3.6, 4.2) Time 0.001 0.02 Mean (sd) 9.0 (1.1) 9.2 (1.5) 7.4 (4.3) Median (Min,Max) 10.0 (7.1, 10.4) 9.4 (2.5, 12.5) 7.7 (1.0, 18.0) Diet 0.89 &lt;0.001 barley 25 (32) 25 (32) 24 (33) barley+lupins 27 (34) 27 (34) 26 (36) lupins 27 (34) 27 (34) 22 (31) "],["nested-summary-of-yard.html", "2.3 Nested summary of yard", " 2.3 Nested summary of yard 2.3.1 By cow: Of the 5 yards, each that had at least one instance of a cow having milk with high protein content and a cow having milk with low protein content. Cows in some yards may have a lower mean time in weeks since calving, but there is no evidence to suggest that is a difference among yards. rm_covsum_nested(data = Milk, id = c(&quot;Cow&quot;), covs = c(&quot;protein&quot;, &quot;Time&quot;), maincov = &quot;Yard&quot;) Full Sample (n=79) 1 (n=13) 2 (n=9) 3 (n=15) 4 (n=19) 5 (n=23) Unnested p-value Nested p-value protein 0.52 0.93 Mean (sd) 3.4 (0.2) 3.5 (0.2) 3.4 (0.1) 3.4 (0.3) 3.4 (0.2) 3.4 (0.2) Median (Min,Max) 3.4 (2.9, 3.9) 3.5 (3.0, 3.8) 3.4 (3.3, 3.6) 3.5 (2.9, 3.9) 3.4 (3.1, 3.8) 3.4 (3.0, 3.7) Time 0.34 0.99 Mean (sd) 9.0 (1.1) 9.0 (1.2) 9.1 (1.2) 9.5 (0.9) 8.7 (1.2) 8.9 (1.1) Median (Min,Max) 10.0 (7.1, 10.4) 10.0 (7.1, 10.1) 10.0 (7.5, 10.4) 10.0 (7.5, 10.0) 8.5 (7.5, 10.0) 9.5 (7.5, 10.2) "],["nested-summary-of-diet.html", "2.4 Nested summary of diet", " 2.4 Nested summary of diet 2.4.1 By cow: It is of interest to note that each of the three diet types is given in each yard. Be aware of reverse causation - high protein milk does not necessarily influence diet type! rm_covsum_nested(data = Milk, id = c(&quot;Cow&quot;), covs = c(&quot;protein&quot;, &quot;High_Protein&quot;, &quot;Time&quot;, &quot;Yard&quot;), maincov = &quot;Diet&quot;) Full Sample (n=79) barley (n=25) barley+lupins (n=27) lupins (n=27) Unnested p-value Nested p-value protein 0.003 0.78 Mean (sd) 3.4 (0.2) 3.5 (0.2) 3.4 (0.1) 3.3 (0.2) Median (Min,Max) 3.4 (2.9, 3.9) 3.6 (3.2, 3.9) 3.4 (3.2, 3.7) 3.3 (2.9, 3.7) High Protein 0.010 0.80 N 63 (80) 15 (60) 23 (85) 25 (93) Y 16 (20) 10 (40) 4 (15) 2 (7) Time 0.97 0.99 Mean (sd) 9.0 (1.1) 9.1 (1.2) 9.0 (1.1) 9.0 (1.1) Median (Min,Max) 10.0 (7.1, 10.4) 10.0 (7.1, 10.4) 10.0 (7.5, 10.1) 10.0 (7.5, 10.2) Yard 0.37 1.00 1 13 (16) 6 (24) 3 (11) 4 (15) 2 9 (11) 4 (16) 3 (11) 2 (7) 3 15 (19) 5 (20) 4 (15) 6 (22) 4 19 (24) 3 (12) 11 (41) 5 (19) 5 23 (29) 7 (28) 6 (22) 10 (37) However, it appear that each cow was assigned to only one diet over all observation instances. Diet 1 = barley, 2 = barley+lupins and 3 = lupins. Diet_t &lt;- reshape2::dcast(Milk, Yard + Cow ~ Time, value.var=&quot;Diet_Type&quot;); colnames(Diet_t)[-c(1:2)] &lt;- paste(&quot;&quot;, colnames(Diet_t[, -c(1:2)]), &quot;&quot;, sep = &quot;&quot;); options(knitr.kable.NA = &#39;&#39;); knitr::kable(Diet_t); Yard Cow 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 1 B07 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 B08 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 B12 1 1 1 1 1 1 1 1 1 1 1 1 1 B13 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 B22 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 B24 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 BL04 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 BL20 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 BL22 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 L16 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 L18 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 L20 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 L21 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 B15 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 B17 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 B20 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 B21 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 BL12 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 BL25 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 BL27 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 L11 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 L24 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 B01 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 B02 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 B10 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 B11 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 B23 1 1 1 1 1 1 1 1 1 1 1 1 1 1 3 BL02 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 BL11 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 BL21 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 BL26 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 L01 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 L02 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 L03 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 L05 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 L07 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 L15 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 B06 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 B16 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 B18 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 4 BL03 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL07 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL09 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL10 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL14 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL15 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL16 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL17 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL19 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL23 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 BL24 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 4 L04 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 L06 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 L09 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 L23 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 L27 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 B03 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 B04 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 B05 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 B09 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 B14 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 B19 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 B25 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 5 BL01 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 BL05 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 BL06 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 BL08 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 BL13 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 BL18 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 5 L08 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L10 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L12 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L13 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L14 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L17 3 3 3 3 3 3 3 3 3 3 3 3 5 L19 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L22 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L25 3 3 3 3 3 3 3 3 3 3 3 3 3 3 5 L26 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 "],["inferential-analysis.html", "3 Inferential analysis ", " 3 Inferential analysis "],["kaplan-meier-survival-curve.html", "3.1 Kaplan-Meier survival curve", " 3.1 Kaplan-Meier survival curve Cows with five consecutive samples of non-high protein milk are designated to going to market. ggkmcif(response = c(&#39;Time&#39;,&#39;Market&#39;), cov=&#39;Diet&#39;, data=Milk_SA); "],["logistic-model.html", "3.2 Logistic model", " 3.2 Logistic model Examine the bivariate relationship first among variables to high protein status of milk. Check for quasi or complete separation of categories. Shout out to Lisa Avery for this function! plotuv(data=Milk, response=&#39;High_Protein&#39;, covs=c(&#39;Cow&#39;, &#39;Yard&#39;, &#39;Diet&#39;, &#39;Time&#39;, &#39;protein&#39;)); Below logistic model does not account for clustering of repeat observations by cow to high protein status of milk. rm_mvsum(model=glm(High_Protein ~ Diet + Yard + Time, data=Milk, family=&#39;binomial&#39;), showN=T, vif=T); OR(95%CI) p-value Global p-value N Event VIF Diet &lt;0.001 1337 0 1.03 barley Reference 425 0 barley+lupins 0.46 (0.34, 0.62) &lt;0.001 459 0 lupins 0.30 (0.22, 0.41) &lt;0.001 453 0 Yard 0.009 1337 0 1.02 1 Reference 220 0 2 0.57 (0.36, 0.91) 0.02 152 0 3 0.86 (0.58, 1.26) 0.43 271 0 4 0.80 (0.54, 1.19) 0.28 312 0 5 0.55 (0.38, 0.80) 0.002 382 0 Time 0.97 (0.95, 1.00) 0.03 1337 0 1.00 "],["generalized-estimating-equations-model.html", "3.3 Generalized estimating equations model", " 3.3 Generalized estimating equations model Below logistic model takes account of repeat observation by cow. Examine different correlation structures. It is of interest to note that (odds of) high protein content in milk appears to decrease as time since calving increases. Milk &lt;- Milk %&gt;% modify_if(is.character, as.factor); Milk &lt;- Milk %&gt;% tidyr::drop_na() Milk &lt;- droplevels(Milk); Milk &lt;- Milk %&gt;% dplyr::arrange(Yard, Cow, Time); rm_mvsum(model=geeglm(HP ~ Diet + Yard + Time, id=c(Cow), data=Milk, family=binomial, corstr=&quot;ar1&quot;), data=Milk, showN=T, CIwidth=0.95); OR(95%CI) p-value Global p-value N Event Diet &lt;0.001 1337 386 barley Reference 425 183 barley+lupins 0.48 (0.26, 0.86) 0.01 459 119 lupins 0.32 (0.18, 0.58) &lt;0.001 453 84 Yard 0.38 1337 386 1 Reference 220 83 2 0.60 (0.30, 1.21) 0.15 152 41 3 0.86 (0.40, 1.84) 0.70 271 85 4 0.77 (0.40, 1.48) 0.44 312 89 5 0.57 (0.31, 1.05) 0.07 382 88 Time 0.92 (0.89, 0.96) &lt;0.001 1337 386 "],["bayesian-hierarchical-model.html", "3.4 Bayesian hierarchical model", " 3.4 Bayesian hierarchical model Below runs a logistic MCMCglmm model treating cow and yard as random effects for 800 posterior samples. Should specify burnin=125000, nitt=625000 and thin=100 for 5000 posterior samples with lower autocorrelation. Aim for effective sample sizes of at least 2000. model1 &lt;- MCMCglmm(HP ~ Diet + Time, random=~Cow + Yard, family=&quot;categorical&quot;, data=Milk, saveX=TRUE, verbose=F, burnin=2000, nitt=10000, thin=10, pr=TRUE, prior=prior2RE); #autocorr.diag(model1$VCV); #use this to choose thinning interval, autocorrelation less than 0.01 ideally; mcmcglmm_mva &lt;- nice_mcmcglmm(model1, Milk); options(knitr.kable.NA = &#39;&#39;); knitr::kable(mcmcglmm_mva); Variable Levels RR (95% HPDI) MCMCp eff.samp Diet barley reference barley+lupins 0.36 (0.16, 0.91) 0.018 589.45 lupins 0.19 (0.08, 0.45) 0.001 326.30 Time 0.96 (0.93, 0.99) 0.018 180.85 Random effects ICC and 95% highest posterior density interval: ICC lower upper Cow 0.6268012 0.4844092 0.7331375 Yard 0.0039214 0.0012423 0.1494174 R-squared calculation with 95% credible intervals for marginal model - considers only the variance of the fixed effects (without the random effects): R_Squared lower upper 0.1525227 0.031263 0.264218 R-squared calculation with 95% credible intervals for conditional model - takes both the fixed and random effects into account: R_Squared lower upper 0.7315872 0.6058629 0.7935015 3.4.1 Variance piechart 3.4.2 Caterpillar plot for random effect of cow Risk ratio of high protein milk among cows is below. Highest posterior density intervals are not necessarily symmetric, but should be close to symmetric upon running more model iterations. Note that cows L23 and L27 have a higher risk estimate for high protein milk in random effect, even though those cows were fed a diet of lupins and should in theory have lower protein milk. Cow B01 also has higher risk of high protein milk, but was always fed a better diet (barley). 3.4.3 Caterpillar plot for random effect of yard Risk ratio of high protein milk among yards is below. Highest posterior density intervals are not necessarily symmetric. "],["biostatsuhnplus.html", "4 BiostatsUHNplus", " 4 BiostatsUHNplus The goal of BiostatsUHNplus is to house publicly available code functions and snippets (multiple package dependencies) used by Biostatistics@UHN. Many of these functions build upon the features of reportRmd. "],["installation.html", "4.1 Installation", " 4.1 Installation You can install the development version of BiostatsUHNplus from GitHub with: # install.packages(&quot;devtools&quot;) devtools::install_github(&quot;biostatsPMH/BiostatsUHNplus&quot;) "],["documentation.html", "4.2 Documentation", " 4.2 Documentation Online Documentation "],["example.html", "4.3 Example", " 4.3 Example 4.3.1 Summary statistics by patient ID nested in cohort, stratified by overall survival status Use model output, and unnested and nested p-value at caution! library(reportRmd); library(BiostatsUHNplus); data(&quot;pembrolizumab&quot;); #str(pembrolizumab); rm_covsum_nested(data = pembrolizumab, id = c(&quot;id&quot;, &quot;cohort&quot;), covs = c(&quot;age&quot;, &quot;sex&quot;, &quot;l_size&quot;, &quot;pdl1&quot;, &quot;tmb&quot;, &quot;baseline_ctdna&quot;, &quot;change_ctdna_group&quot;, &quot;orr&quot;, &quot;cbr&quot;, &quot;os_time&quot;, &quot;pfs_status&quot;, &quot;pfs_time&quot;), maincov = &quot;os_status&quot;); #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: age #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: sex, id, cohort #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: l_size #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: pdl1 #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: tmb #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: baseline_ctdna #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: change_ctdna_group, id, cohort #&gt; Contrasts set to contr.sum for the following variables: orr, id, cohort #&gt; Contrasts set to contr.sum for the following variables: cbr, id, cohort #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: os_time #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: pfs_status #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. #&gt; Contrasts set to contr.sum for the following variables: id, cohort #&gt; Numerical variables NOT centered on 0: pfs_time #&gt; If in interactions, interpretation of lower order (e.g., main) effects difficult. Full Sample (n=94) 0 (n=30) 1 (n=64) Unnested p-value Nested p-value age 0.28 0.18 Mean (sd) 57.9 (12.8) 60.4 (11.8) 56.7 (13.1) Median (Min,Max) 59.1 (21.1, 81.8) 62.8 (34.1, 81.8) 57.9 (21.1, 78.2) sex 1.00 0.82 Female 58 (62) 19 (63) 39 (61) Male 36 (38) 11 (37) 25 (39) l size 0.34 0.35 Mean (sd) 87.9 (59.6) 79.9 (49.9) 91.7 (63.6) Median (Min,Max) 73.5 (11.0, 387.0) 65.5 (11.0, 241.0) 77 (12, 387) pdl1 0.05 0.010 Mean (sd) 13.9 (29.2) 25.6 (39.3) 8.3 (21.2) Median (Min,Max) 0 (0, 100) 1 (0, 100) 0 (0, 95) Missing 1 0 1 tmb 0.64 0.12 Mean (sd) 0.9 (1.0) 1.1 (1.3) 0.8 (0.7) Median (Min,Max) 0.7 (-0.8, 5.2) 0.6 (-0.8, 5.2) 0.7 (-0.6, 3.2) baseline ctdna &lt;0.001 0.02 Mean (sd) 358.7 (674.0) 162.4 (347.7) 450.7 (766.8) Median (Min,Max) 86 (0, 4475) 11.0 (0.0, 1303.7) 165.6 (0.1, 4475.0) change ctdna group 0.002 &lt;0.001 Decrease from baseline 33 (45) 19 (70) 14 (30) Increase from baseline 40 (55) 8 (30) 32 (70) Missing 21 3 18 orr &lt;0.001 &lt;0.001 CR/PR 16 (17) 14 (47) 2 (3) SD/PD 78 (83) 16 (53) 62 (97) cbr &lt;0.001 &lt;0.001 CR/PR/SD&gt;=C6 24 (26) 17 (57) 7 (11) PD/SD 70 (74) 13 (43) 57 (89) os time &lt;0.001 &lt;0.001 Mean (sd) 14.7 (10.2) 25.7 (6.8) 9.6 (7.1) Median (Min,Max) 13.8 (0.6, 35.4) 26.7 (9.5, 35.4) 7.8 (0.6, 27.5) pfs status &lt;0.001 Did not converge;quasi or completecategory separation Mean (sd) 0.9 (0.3) 0.6 (0.5) 1.0 (0.0) Median (Min,Max) 1 (0, 1) 1 (0, 1) 1 (1, 1) pfs time &lt;0.001 &lt;0.001 Mean (sd) 6.2 (8.7) 14.3 (11.7) 2.5 (2.0) Median (Min,Max) 1.9 (0.4, 35.4) 14.9 (0.8, 35.4) 1.9 (0.4, 10.1) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
